# Genshin Build Card Creator - Project Context & Rules

このプロジェクトは、原神（Genshin Impact）のキャラクタービルドカードを生成するためのWebアプリケーションです。

## 技術スタック
- **Framework**: Next.js 15+ (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS 4.0
- **Icons**: Lucide React
- **Image Generation**: html-to-image, html2canvas
- **API Integration**: Enka.Network (via Proxy)

## 設計方針
- **Visual Excellence**: ユーザーを驚かせるようなプレミアムでモダンなデザイン（グラデーション、ダークモード、ガラスモーフィズム、マイクロアニメーション）を重視。
- **Responsive Design**: プレビューエリアはスケーリングを使用して、異なる画面サイズでもカードのレイアウトを維持。
- **Component-Based**: UI要素は再利用可能なコンポーネントとして分割（BuildCard, InputForm, StatRow, TalentDisplay等）。
- **Data-Driven**: Enka.Network APIからのデータをマッピングし、自動入力と手動編集の両方をサポート。

## 現在の実装状況
- [x] 基本的なプロジェクト構成（Next.js + Tailwind CSS）
- [x] ビルドカードのプレビュー表示（BuildCard.tsx）
- [x] 入力フォームの実装（InputForm.tsx）
- [x] Enka.Network API プロキシとデータマッピング
- [x] 聖遺物スコア計算ロジック（score.ts）
- [x] カードの画像ダウンロード機能（html-to-image）
- [x] 武器情報の詳細表示（精錬ランク、ステータス、レアリティ）
- [x] 命ノ星座のアイコン表示
- [x] 天賦レベルの表示
- [x] UI/UXの大幅な改善:
    - [x] **入力フォームのサイドバー化**: 折りたたみ可能なサイドバーを実装。
    - [x] **カスタムドロップダウン**: キャラ名、武器名、聖遺物セット名を検索可能に刷新。
    - [x] **フィルタリング・ソート**: キャラ種に応じた武器フィルタ、レアリティ順ソート。
    - [x] **インタラクティブUI**: 凸や聖遺物レアリティをアイコンクリックで変更可能。
    - [x] **多言語対応（日本語化）**: サイドバー項目、聖遺物部位名等の完全日本語化。
    - [x] **表示ロジックの改善**:
        - 聖遺物レベル（+20）をメインステータス下へ移動、+20で金色表示。
        - 聖遺物セットアイコンの表示（背景透過、ドロップシャドウ）。
        - 天賦ブーストカラーの金色化、聖遺物枠の不透明度調整（60%）。

## 今後のタスク
- [ ] キャラクター/武器の画像アセットの動的取得の最適化
- [ ] 複数のスコア計算基準（HP型、防御型、熟知型など）のユーザー選択機能の強化
- [ ] カードデザインのバリエーション追加
- [ ] モバイル端末でのレイアウト最適化のさらなる改善

### 2026-01-21 更新分 (自動化・利便性向上)
- [x] **天賦入力の強化**:
    - サイドバーにレベル入力とBoost切替機能を追加。
    - キャラ選択時に天賦アイコンを自動取得。
- [x] **聖遺物/武器の画像自動化**:
    - 聖遺物セット選択時、部位（花・羽・等）に応じた画像を自動設定。
    - 武器選択・入力時、レア度と画像を自動設定。
- [x] **ステータス入力の効率化**:
    - 聖遺物メインステータスのドロップダウン化（部位ごとに適切な候補を表示）。
    - レア度とレベルに応じたメインステータス値の自動計算・反映。
    - 花と羽のメインステータス固定（HP/攻撃力）。
- [x] **データ管理機能**:
    - 「データクリア」ボタンの実装（確認ダイアログ付き、UID含む全クリア）。
- [x] **UI微調整**:
    - サブステータス入力欄を常に4枠表示。

## 開発ルール
- **言語**: 日本語で思考し、日本語で応答すること。
- **デザイン**: 常に「WOW」を感じさせるプレミアムなデザインを優先する。
- **コード品質**: TypeScriptの型定義を厳格に行い、マジックナンバーを避ける。
- **ファイル構成**: `src/components` にUI、`src/utils` にロジック、`src/types` に型定義を配置する。
